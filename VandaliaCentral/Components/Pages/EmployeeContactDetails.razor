@page "/employeecontacts/{id}"
@inject Microsoft.Graph.GraphServiceClient GraphClient
@using Microsoft.Graph

<div class="px-3">
    <h4>Employee Details</h4>

    @if (contact == null)
    {
        <p>Loading...</p>
    }
    else
    {
        <div class="card p-3 shadow">
            <h5>@contact.DisplayName</h5>
            <br>
            <p><strong>District:</strong> @contact.PostalCode</p>
            <p><strong>Location:</strong> @contact.OfficeLocation</p>
            <p><strong>Job Title:</strong> @contact.JobTitle</p>
            <p><strong>Email:</strong> @contact.Mail</p>
            <p><strong>Phone:</strong> @contact.MobilePhone</p>
            <p><strong>IP Phone:</strong> @(contact.BusinessPhones?.FirstOrDefault() ?? "")</p>
            
        </div>
    }
</div>

@code {
    [Parameter] public string id { get; set; }
    private User contact;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            contact = await GraphClient.Users[id].Request().GetAsync();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading contact: {ex.Message}");
        }
    }
}

